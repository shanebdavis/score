import &StandardImport

class Player extends IndexedDbPipeline
  @addDatabaseFilters
    name:           "" required trimmedString
    preferredColor: :trimmedString
    selectedAt:     :timestamp

  @query
    allPlayers:
      query: (request) ->
        request.subrequest :player :getAll
        .then (games) -> games.sort (a, b) ->
          (b.selectedAt ? b.updatedAt) -
          (a.selectedAt ? a.updatedAt)

      dataToKeyString: -> "all"
